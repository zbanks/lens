digraph {
    input;
    print_ipv4 [type=print prefix=IPV4];
    print_dns [type=print prefix=DNS];
    print_udp [type=print prefix=UDP];
    print_tcp [type=print prefix=TCP all=0];
    output [type=output];

    input -> eth_dec;
    eth_dec -> ipv4_dec [ethertype=ipv4];
    ipv4_dec -> udp_dec [proto=udp];
    udp_dec -> dns_dec [port=53];
    ipv4_dec -> tcp_dec [proto=tcp];
    tcp_dec -> print_tcp;
    /*
    dns_dec -> print_dns;
    udp_dec -> print_udp [unmatched=1];
    */
}
